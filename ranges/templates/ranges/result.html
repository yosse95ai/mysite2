{% extends './base.html' %}
{% load note_control %}
{% block title %}検索結果{% endblock title %}
{% block page_name %}
<i class="fas fa-search has-text-grey-lighter"></i><span class="has-text-grey-dark"> {{input_name}}</span>
{% endblock page_name %}

{% block content %}
<div class="box">
    {# search for Range #}
    {% if range_error or song_error or range_note_error %}
    <div class="columns">
        {% if range_error %}
        <div class="column subtitle">
            <i class="fas fa-chevron-right"></i>
            <a href="#" class="has-text-dark">
                <span class="has-text-danger">{{input_name}}</span>の音域の登録に協力してくれませんか？</a>
        </div>
        {% elif song_error %}
        <div class="column subtitle">
            <i class="fas fa-chevron-right"></i><a href="#" class="has-text-dark">
                <span class="has-text-danger">{{input_name}}</span>
                を曲データベースに登録しませんか？</a>
        </div>
        {% endif %}
    </div>
    <div class="content has-text-grey-light">
        検索結果：0件{{range_note_error}}
    </div>
    {% elif results %}
    {##}{% for result in results %}
    <div class="columns level is-gapless">
        <div class="level-left">
            <div class="column">
                <a href="{% url 'ranges:detail' result.artist.pk result.song.pk %}"
                    class="title is-5 has-text-info">{{result.song.song_name}}</a>
            </div>
            <div class="columns is-mobile">
                <div class="column">
                    <a href="#" class="title is-6">{{ result.artist.artist_name }}</a></div>
            </div>
        </div>
        <div class="level-right">
            <div class="column tags are-medium">
                <a href="{% url 'ranges:result_range' result.lowest_note.pk %}">
                    <div class="tag {{ result.lowest_note.pk | color }}">
                        {{ result.lowest_note }}
                    </div>
                </a>
                <a href="{% url 'ranges:result_range' result.highest_note.pk %}">
                    <div class="tag {{ result.highest_note.pk | color }}">
                        {{ result.highest_note }}
                    </div>
                </a>
            </div>
        </div>
    </div>
    {######}{% if forloop.last %}
    <div class="content has-text-grey-light">
        検索結果：{{ results.paginator.num_pages }}件
    </div>
    {######}{% endif %}
    {##}{% endfor %}
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        {% if results.has_previous %}
        <a class="pagination-previous" href="{% url 'ranges:result' input_name %}?page=1">
            <i class="fas fa-chevron-left"></i><i class="fas fa-chevron-left"></i></a>
        {% endif %}
        {% if results.has_next %}
        <a class="pagination-next" href="{% url 'ranges:result' input_name %}?page={{ results.paginator.num_pages }}">
            <i class="fas fa-chevron-right"></i><i class="fas fa-chevron-right"></i></a>
        {% endif %}
        <ul class="pagination-list">
            <li>
                {% if results.has_previous %}
                <a class="pagination-previous"
                    href="{% url 'ranges:result' input_name %}?page={{ results.previous_page_number }}">
                    <i class="fas fa-chevron-left"></i></a>
                {% endif %}
            </li>
            <li><a class="pagination-link is-current" aria-label="Page {{ results.number }}"
                    aria-current="page">{{ results.number }}</a>
            </li>
            <li>
                {% if results.has_next %}
                <a class="pagination-next"
                    href="{% url 'ranges:result' input_name %}?page={{ results.next_page_number }}">
                    <i class="fas fa-chevron-right"></i></a>
                {% endif %}
            </li>
        </ul>
    </nav>
    {# search for Note #}
    {% elif high_ranges or low_ranges %}
    {##}{% if high_ranges %}
    {######}{% for result in high_ranges %}
    <div class="columns level is-gapless">
        <div class="level-left">
            <div class="column">
                <a href="{% url 'ranges:detail' result.artist.pk result.song.pk %}"
                    class="title is-5 has-text-info">{{result.song.song_name}}</a>
            </div>
            <div class="columns is-mobile">
                <div class="column">
                    <a href="#" class="title is-6">{{ result.artist.artist_name }}</a></div>
            </div>
        </div>
        <div class="level-right">
            <div class="column tags are-medium">
                <a href="{% url 'ranges:result_range' result.lowest_note.pk %}">
                    <div class="tag {{ result.lowest_note.pk | color }}">
                        {{ result.lowest_note }}
                    </div>
                </a>
                <a href="{% url 'ranges:result_range' result.highest_note.pk %}">
                    <div class="tag {{ result.highest_note.pk | color }}">
                        {{ result.highest_note }}
                    </div>
                </a>
            </div>
        </div>
    </div>
    {######}{% endfor %}
    {##}{% elif low_ranges %}
    {######}{% for result in low_ranges %}
    <div class="columns level is-gapless">
        <div class="level-left">
            <div class="column">
                <a href="{% url 'ranges:detail' result.artist.pk result.song.pk %}"
                    class="title is-5 has-text-info">{{result.song.song_name}}</a>
            </div>
            <div class="columns is-mobile">
                <div class="column">
                    <a href="#" class="title is-6">{{ result.artist.artist_name }}</a></div>
            </div>
        </div>
        <div class="level-right">
            <div class="column tags are-medium">
                <a href="{% url 'ranges:result_range' result.lowest_note.pk %}">
                    <div class="tag {{ result.lowest_note.pk | color }}">
                        {{ result.lowest_note }}
                    </div>
                </a>
                <a href="{% url 'ranges:result_range' result.highest_note.pk %}">
                    <div class="tag {{ result.highest_note.pk | color }}">
                        {{ result.highest_note }}
                    </div>
                </a>
            </div>
        </div>
    </div>
    {######}{% endfor %}
    {##}{% endif %}
    <div class="content has-text-grey-light">
        検索結果：{{h_num|add:l_num}}件
    </div>
    {# search for Genre #}
    {% elif range_list %}
    {##}{% for result in range_list %}
    <div class="columns level is-gapless">
        <div class="level-left">
            <div class="column">
                <a href="{% url 'ranges:detail' result.artist.pk result.song.pk %}"
                    class="title is-5 has-text-info">{{result.song.song_name}}</a>
            </div>
            <div class="columns is-mobile">
                <div class="column">
                    <a href="#" class="title is-6">{{ result.artist.artist_name }}</a></div>
            </div>
        </div>
        <div class="level-right">
            <div class="column tags are-medium">
                <a href="{% url 'ranges:result_range' result.lowest_note.pk %}">
                    <div class="tag {{ result.lowest_note.pk | color }}">
                        {{ result.lowest_note }}
                    </div>
                </a>
                <a href="{% url 'ranges:result_range' result.highest_note.pk %}">
                    <div class="tag {{ result.highest_note.pk | color }}">
                        {{ result.highest_note }}
                    </div>
                </a>
            </div>
        </div>
    </div>
    {######}{% if forloop.last %}
    <div class="content has-text-grey-light">
        検索結果：{{forloop.counter}}件
    </div>
    {######}{% endif %}
    {##}{% endfor %}
    {% endif %}
</div>
{% endblock content %}